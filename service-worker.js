!function(){"use strict";function n(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function t(n,t){var e=Object.keys(n);return Object.getOwnPropertySymbols&&e.push.apply(e,Object.getOwnPropertySymbols(n)),t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e}var e;!function(n){n.CLICK="click",n.CLICK_BUTTON_1="click_button_1",n.CLICK_BUTTON_2="click_button_2"}(e||(e={}));function i(n){null!=n.internalEventGid&&caches.open("repro_cache_v1").then((function(t){var e,i=Date.now();e="show"===n.action?"".concat("/repro/cache","?action=show&internal_event_gid=").concat(n.internalEventGid,"&tracked_at=").concat(i):"".concat("/repro/cache","?action=click&internal_event_gid=").concat(n.internalEventGid,"?click_action=").concat(n.action,"&tracked_at=").concat(i),t.put(e,new Response(e))}))}self.addEventListener("push",(function(e){if(null!=e.data){var c=e.data.json();i({action:"show",internalEventGid:c.options.data.internal_event_gid}),e.waitUntil(self.registration.showNotification(c.title,function(e){for(var i=1;i<arguments.length;i++){var c=null!=arguments[i]?arguments[i]:{};i%2?t(c,!0).forEach((function(t){n(e,t,c[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):t(c).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(c,n))}))}return e}({},c.options)))}})),self.addEventListener("install",(function(n){n.waitUntil(self.skipWaiting())})),self.addEventListener("activate",(function(n){n.waitUntil(self.clients.claim())})),self.addEventListener("notificationclick",(function(n){n.notification.close();var t=n.notification.data,c=e.CLICK,r=null;switch(n.action){case"":r=t.notification_click_url||null;break;case n.notification.actions[0].action:c=e.CLICK_BUTTON_1,r=t.action_click_1_url||null;break;case n.notification.actions[1].action:c=e.CLICK_BUTTON_2,r=t.action_click_2_url||null}if(i({action:c,internalEventGid:t.internal_event_gid}),null!=r){var o=self.clients.matchAll({type:"window",includeUncontrolled:!0}).then((function(n){for(var t=0;t<n.length;t+=1){var e=n[t];if(e.url===r)return e.focus()}return self.clients.openWindow(r)}));n.waitUntil(o)}})),self.addEventListener("fetch",(function(n){if("/repro/cache"===new URL(n.request.url).pathname){var t=caches.open("repro_cache_v1").then((function(t){return t.matchAll(n.request.url,{cacheName:"repro_cache_v1",ignoreSearch:!0}).then((function(n){return Promise.all(n.map((function(n){return n.text()})))})).then((function(n){return new Response(btoa(JSON.stringify(n)))})).finally((function(){t.delete(n.request.url,{ignoreSearch:!0})}))}));n.respondWith(t)}}))}();
